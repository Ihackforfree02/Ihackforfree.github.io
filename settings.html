<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Settings</title>
  <link rel="icon" href="favicon.ico" />
  <style>
    /* [Same CSS as before — unchanged for brevity] */
    /* You can keep your original CSS here */
  </style>
</head>
<body>
  <div class="container">
    <h1>Settings</h1>

    <!-- Tab Cloak Controls -->
    <label for="cloakSelector">🕵️ Select Tab Cloak</label>
    <select id="cloakSelector">
      <option value="">-- Select Tab Cloak --</option>
      <option value="Google Docs">Google Docs</option>
      <option value="Google Classroom">Google Classroom</option>
      <option value="Google Slides">Google Slides</option>
      <option value="Gmail">Gmail</option>
      <option value="MR GAMES">MR GAMES (Default)</option>
    </select>

    <label>
      <input type="checkbox" id="cloakToggle" />
      Enable Tab Cloak
    </label>

    <button onclick="saveCloak()">Save Cloak</button>

    <!-- Panic Button Setup -->
    <label for="panicURL">🚨 Panic Redirect URL</label>
    <input type="text" id="panicURL" placeholder="https://example.com" />

    <label for="panicKey">⌨️ Panic Key (single letter)</label>
    <input type="text" id="panicKey" maxlength="1" placeholder="e.g. P" />

    <button onclick="savePanic()">Save Panic Settings</button>

    <!-- Copy to Clipboard -->
    <label for="copyText">📋 Text to Copy</label>
    <input type="text" id="copyText" placeholder="Type something..." />
    <button onclick="copyToClipboard()">Copy</button>
  </div>

  <div class="rain-wrapper"></div>

  <script>
    // Rain animation
    const rainWrapper = document.querySelector('.rain-wrapper');
    const numRaindrops = 100;
    for (let i = 0; i < numRaindrops; i++) {
      const drop = document.createElement('div');
      drop.className = 'raindrop';
      drop.style.left = Math.random() * 100 + 'vw';
      drop.style.height = (10 + Math.random() * 20) + 'px';
      drop.style.animationDuration = (2 + Math.random() * 3) + 's';
      drop.style.animationDelay = (Math.random() * 5) + 's';
      rainWrapper.appendChild(drop);
    }

    // Tab Cloak logic
    const cloakToggle = document.getElementById('cloakToggle');
    const cloakSelector = document.getElementById('cloakSelector');
    const favicons = {
      "Google Docs": "https://ssl.gstatic.com/docs/doclist/images/mediatype/icon_1_document_x32.png",
      "Google Classroom": "https://ssl.gstatic.com/classroom/favicon.png",
      "Google Slides": "https://ssl.gstatic.com/docs/doclist/images/mediatype/icon_10_presentation_x32.png",
      "Gmail": "https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico",
      "MR GAMES": "favicon.ico"
    };

    function applyCloak(name) {
      if (!name) return;
      document.title = name;
      let link = document.querySelector("link[rel~='icon']");
      if (!link) {
        link = document.createElement('link');
        link.rel = 'icon';
        document.head.appendChild(link);
      }
      link.href = favicons[name] || favicons["MR GAMES"];
    }

    function resetCloak() {
      document.title = "Settings";
      let link = document.querySelector("link[rel~='icon']");
      if (link) link.href = favicons["MR GAMES"];
    }

    function saveCloak() {
      const enabled = cloakToggle.checked;
      const name = cloakSelector.value;
      localStorage.setItem("cloakEnabled", enabled);
      localStorage.setItem("cloakName", name);
      if (enabled) {
        applyCloak(name);
      } else {
        resetCloak();
      }
      alert("Cloak settings saved!");
    }

    // Load cloak settings on page load
    window.addEventListener("load", () => {
      const enabled = localStorage.getItem("cloakEnabled") === "true";
      const name = localStorage.getItem("cloakName");
      cloakToggle.checked = enabled;
      cloakSelector.value = name || "";
      if (enabled && name) applyCloak(name);
    });

    // Panic logic
    function savePanic() {
      const url = document.getElementById("panicURL").value.trim();
      const key = document.getElementById("panicKey").value.trim().toLowerCase();
      if (!url || !key || key.length !== 1) {
        alert("Please enter a valid URL and a single key.");
        return;
      }
      localStorage.setItem("panicLink", url);
      localStorage.setItem("panicKey", key);
      alert(`✅ Panic settings saved! Press '${key.toUpperCase()}' to activate.`);
    }

    document.addEventListener("keydown", function(e) {
      const savedLink = localStorage.getItem("panicLink");
      const savedKey = localStorage.getItem("panicKey");
      if (savedLink && savedKey && e.key.toLowerCase() === savedKey) {
        window.location.href = savedLink;
      }
    });

    // Copy to clipboard
    function copyToClipboard() {
      const copyInput = document.getElementById("copyText");
      copyInput.select();
      copyInput.setSelectionRange(0, 99999); // For mobile
      navigator.clipboard.writeText(copyInput.value)
        .then(() => alert("Copied to clipboard!"))
        .catch(() => alert("Failed to copy."));
    }
  </script>
</body>
</html>
